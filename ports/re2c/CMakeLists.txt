cmake_minimum_required(VERSION 3.0)
project(re2c)

file(GLOB HEADERS
	src/code/bitmap.h
	src/code/emit.h
	src/code/go.h
	src/code/input_api.h
	src/code/label.h
	src/code/output.h
	src/code/print.h
	src/conf/msg.h
	src/conf/opt.h
	src/conf/warn.h
	src/adfa/action.h
	src/adfa/adfa.h
	src/adfa/dump.h
	src/dfa/cfg/cfg.h
	src/dfa/closure.h
	src/dfa/dfa.h
	src/dfa/dump.h
	src/dfa/find_state.h
	src/dfa/tagpool.h
	src/dfa/tagtree.h
	src/dfa/tcmd.h
	src/nfa/nfa.h
	src/re/encoding/case.h
	src/re/encoding/enc.h
	src/re/encoding/range_suffix.h
	src/re/encoding/utf8/utf8.h
	src/re/encoding/utf8/utf8_regexp.h
	src/re/encoding/utf8/utf8_range.h
	src/re/encoding/utf16/utf16_range.h
	src/re/encoding/utf16/utf16_regexp.h
	src/re/encoding/utf16/utf16.h
	src/re/empty_class_policy.h
	src/re/re.h
	src/re/rule.h
	src/re/tag.h
	src/compile.h
	src/skeleton/path.h
	src/skeleton/skeleton.h
	src/ast/ast.h
	src/ast/input.h
	src/ast/parser.h
	src/ast/scanner.h
	src/ast/unescape.h
	src/util/allocate.h
	src/util/attribute.h
	src/util/c99_stdint.h
	src/util/counter.h
	src/util/forbid_copy.h
	src/util/free_list.h
	src/util/hash32.h
	src/util/local_increment.h
	src/util/lookup.h
	src/util/range.h
	src/util/s_to_n32_unsafe.h
	src/util/slab_allocator.h
	src/util/smart_ptr.h
	src/util/static_assert.h
	src/util/string_utils.h
	src/util/u32lim.h
	src/util/uniq_vector.h
	src/util/wrap_iter.h 
)

file(GLOB SRC
	src/code/bitmap.cc
	src/code/emit_action.cc
	src/code/emit_dfa.cc
	src/code/label.cc
	src/code/go_construct.cc
	src/code/go_destruct.cc
	src/code/go_emit.cc
	src/code/go_used_labels.cc
	src/code/input_api.cc
	src/code/output.cc
	src/code/print.cc
	src/conf/msg.cc
	src/conf/opt.cc
	src/conf/warn.cc
	src/nfa/dump.cc
	src/nfa/estimate_size.cc
	src/nfa/re_to_nfa.cc
	src/adfa/adfa.cc
	src/adfa/dump.cc
	src/adfa/prepare.cc
	src/dfa/cfg/cfg.cc
	src/dfa/cfg/compact.cc
	src/dfa/cfg/dce.cc
	src/dfa/cfg/dump.cc
	src/dfa/cfg/freeze.cc
	src/dfa/cfg/interfere.cc
	src/dfa/cfg/liveanal.cc
	src/dfa/cfg/normalize.cc
	src/dfa/cfg/optimize.cc
	src/dfa/cfg/rename.cc
	src/dfa/cfg/varalloc.cc
	src/dfa/closure.cc
	src/dfa/dead_rules.cc
	src/dfa/determinization.cc
	src/dfa/dump.cc
	src/dfa/fallback_tags.cc
	src/dfa/fillpoints.cc
	src/dfa/find_state.cc
	src/dfa/minimization.cc
	src/dfa/tagpool.cc
	src/dfa/tagtree.cc
	src/dfa/tcmd.cc
	src/re/encoding/enc.cc
	src/re/encoding/range_suffix.cc
	src/re/encoding/utf8/utf8_regexp.cc
	src/re/encoding/utf8/utf8_range.cc
	src/re/encoding/utf8/utf8.cc
	src/re/encoding/utf16/utf16_regexp.cc
	src/re/encoding/utf16/utf16.cc
	src/re/encoding/utf16/utf16_range.cc
	src/re/ast_to_re.cc
	src/re/default_tags.cc
	src/re/fixed_tags.cc
	src/re/nullable.cc
	src/re/rule.cc
	src/re/split_charset.cc
	src/re/tag.cc
	src/compile.cc
	src/skeleton/control_flow.cc
	src/skeleton/generate_code.cc
	src/skeleton/generate_data.cc
	src/skeleton/maxpath.cc
	src/skeleton/skeleton.cc
	src/main.cc
	src/ast/ast.cc
	src/ast/input.cc
	src/ast/normalize.cc
	src/ast/scanner.cc
	src/ast/unescape.cc
	src/ast/validate.cc
	src/util/s_to_n32_unsafe.cc
	src/util/range.cc 
)

file(GLOB BOOTSTRAP_SRC
	bootstrap/src/ast/lex.cc
	bootstrap/src/ast/lex_conf.cc
	bootstrap/src/conf/parse_opts.cc
	bootstrap/src/ast/parser.cc
#	bootstrap/src/ast/y.tab.h
	bootstrap/src/conf/help.cc 
)

include_directories(${CMAKE_CURRENT_SOURCE_DIR})

add_executable(re2c ${BOOTSTRAP_SRC} ${SRC})

install(TARGETS re2c DESTINATION tools CONFIGURATIONS Release)
